<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>新浪博客备份工具 - Dature</title>
    <script>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?a170ee027e1c9962d11e93ca6822bfbd";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <style>
      :root {
        --primary: #00c2ff;
        --primary-dark: #0099cc;
        --secondary: #6c63ff;
        --dark: #121212;
        --darker: #0a0a0a;
        --light: #f8f9fa;
        --gray: #2d2d2d;
        --border: rgba(255, 255, 255, 0.1);
        --success: #00d26a;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, var(--darker), var(--dark));
        color: var(--light);
        min-height: 100vh;
        line-height: 1.6;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
      }

      header {
        text-align: center;
        margin-bottom: 3rem;
        padding-top: 2rem;
      }

      .logo {
        font-size: 2.5rem;
        font-weight: 700;
        background: linear-gradient(to right, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 0.5rem;
      }

      .tagline {
        font-size: 1.2rem;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 2rem;
      }

      .card {
        background: rgba(30, 30, 30, 0.5);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        border: 1px solid var(--border);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .card-title {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: var(--primary);
        display: flex;
        align-items: center;
      }

      .card-title i {
        margin-right: 10px;
        font-size: 1.8rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.9);
      }

      input,
      textarea {
        width: 100%;
        padding: 14px;
        border-radius: 8px;
        background: rgba(20, 20, 20, 0.7);
        border: 1px solid var(--border);
        color: white;
        font-family: inherit;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(0, 194, 255, 0.2);
      }

      textarea {
        min-height: 120px;
        resize: vertical;
      }

      .btn {
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 14px 28px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .btn i {
        margin-right: 8px;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 194, 255, 0.3);
      }

      .help-link {
        display: inline-block;
        margin-top: 1rem;
        color: rgba(255, 255, 255, 0.7);
        text-decoration: none;
        font-size: 0.9rem;
        transition: color 0.3s ease;
      }

      .help-link:hover {
        color: var(--primary);
      }

      .console {
        background: rgba(10, 10, 10, 0.8);
        border-radius: 8px;
        padding: 1.5rem;
        min-height: 300px;
        max-height: 400px;
        overflow-y: auto;
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
        border: 1px solid var(--border);
        color: #00ff99;
      }

      .console-line {
        margin-bottom: 8px;
        line-height: 1.4;
      }

      .error {
        color: #ff4d4d;
        margin-bottom: 1rem;
        font-weight: 500;
      }

      .success {
        color: var(--success);
        margin-top: 1rem;
      }

      .success a {
        color: var(--primary);
        text-decoration: none;
        font-weight: 500;
      }

      .success a:hover {
        text-decoration: underline;
      }

      footer {
        text-align: center;
        margin-top: 3rem;
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.95rem;
        padding-bottom: 2rem;
        display: flex;
        justify-content: center;
      }

      .contact-info {
        margin-left: 3.5rem;
      }

      .contact-info p {
        font-weight: 500;
        margin-bottom: 0.5rem;
      }

      .contact-info ul {
        list-style: none;
        padding: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1.5rem;
        margin: 0 auto;
        max-width: 600px;
      }

      .contact-info li {
        display: flex;
        align-items: center;
      }

      .contact-info a {
        color: var(--primary);
        text-decoration: none;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.2rem;
      }

      .contact-info a:hover {
        color: var(--secondary);
        text-decoration: underline;
      }

      @media (max-width: 600px) {
        .container {
          padding: 1.5rem;
        }

        .card {
          padding: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo">Dature</div>
        <div class="tagline">安全备份您的新浪博客内容</div>
      </header>

      <main>
        <div class="card">
          <h2 class="card-title"><i>📝</i> 博客备份设置</h2>

          <div class="error" id="err"></div>

          <div class="form-group">
            <label for="uid">新浪博客 UID</label>
            <input
              type="text"
              id="uid"
              name="uid"
              placeholder="请输入您的博客UID (例如: 123456789)"
            />
          </div>

          <div class="form-group">
            <label for="cookie">新浪 Cookie</label>
            <textarea
              id="cookie"
              name="cookie"
              placeholder="粘贴您的Cookie内容..."
            ></textarea>
          </div>

          <div class="form-group">
            <label>
              <input
                type="checkbox"
                id="rebackup"
                name="rebackup"
                style="width: auto"
              />
              重新备份（删除旧数据）
            </label>
          </div>

          <button class="btn" id="btn"><i>🚀</i> 开始备份</button>

          <a
            href="https://gitee.com/junyiz/dature#如何查看新浪博客的-uid"
            class="help-link"
            target="_blank"
          >
            <i>❓</i> 如何获取 UID 和 Cookie？
          </a>
        </div>

        <div class="card">
          <h2 class="card-title"><i>📋</i> 备份日志</h2>
          <div class="console" id="out"></div>
          <div class="success" id="success"></div>
        </div>
      </main>

      <footer>
        <p>© 2025 Dature 新浪博客备份工具 | 安全可靠的数据备份方案</p>
        <div class="contact-info">
          <ul>
            <li>
              <a href="https://x.com/Junyily" target="_blank">
                <svg
                  stroke="currentColor"
                  fill="currentColor"
                  stroke-width="0"
                  viewBox="0 0 24 24"
                  class="size-4"
                  height="0.8em"
                  width="0.8em"
                  xmlns="http://www.w3.org/2000/svg"
                  style="cursor: default"
                >
                  <path
                    d="M17.6874 3.0625L12.6907 8.77425L8.37045 3.0625H2.11328L9.58961 12.8387L2.50378 20.9375H5.53795L11.0068 14.6886L15.7863 20.9375H21.8885L14.095 10.6342L20.7198 3.0625H17.6874ZM16.6232 19.1225L5.65436 4.78217H7.45745L18.3034 19.1225H16.6232Z"
                  ></path></svg
              ></a>
            </li>
            <li>
              <a
                href="https://www.xiaohongshu.com/user/profile/6168035a000000001f03efe4"
                target="_blank"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="1.5em"
                  height="1.5em"
                  viewBox="0 0 24 24"
                >
                  <path
                    fill="currentColor"
                    d="M22.405 9.879c.002.016.01.02.07.019h.725a.797.797 0 0 0 .78-.972a.794.794 0 0 0-.884-.618a.795.795 0 0 0-.692.794c0 .101-.002.666.001.777m-11.509 4.808c-.203.001-1.353.004-1.685.003a2.5 2.5 0 0 1-.766-.126a.025.025 0 0 0-.03.014L7.7 16.127a.025.025 0 0 0 .01.032c.111.06.336.124.495.124c.66.01 1.32.002 1.981 0q.017 0 .023-.015l.712-1.545a.025.025 0 0 0-.024-.036zM.477 9.91c-.071 0-.076.002-.076.01l-.01.08c-.027.397-.038.495-.234 3.06c-.012.24-.034.389-.135.607c-.026.057-.033.042.003.112c.046.092.681 1.523.787 1.74c.008.015.011.02.017.02c.008 0 .033-.026.047-.044q.219-.282.371-.606c.306-.635.44-1.325.486-1.706c.014-.11.021-.22.03-.33l.204-2.616l.022-.293c.003-.029 0-.033-.03-.034zm7.203 3.757a1.4 1.4 0 0 1-.135-.607c-.004-.084-.031-.39-.235-3.06a.4.4 0 0 0-.01-.082c-.004-.011-.052-.008-.076-.008h-1.48c-.03.001-.034.005-.03.034l.021.293q.114 1.473.233 2.946c.05.4.186 1.085.487 1.706c.103.215.223.419.37.606c.015.018.037.051.048.049c.02-.003.742-1.642.804-1.765c.036-.07.03-.055.003-.112m3.861-.913h-.872a.126.126 0 0 1-.116-.178l1.178-2.625a.025.025 0 0 0-.023-.035l-1.318-.003a.148.148 0 0 1-.135-.21l.876-1.954a.025.025 0 0 0-.023-.035h-1.56q-.017 0-.024.015l-.926 2.068c-.085.169-.314.634-.399.938a.5.5 0 0 0-.02.191a.46.46 0 0 0 .23.378a1 1 0 0 0 .46.119h.59c.041 0-.688 1.482-.834 1.972a.5.5 0 0 0-.023.172a.47.47 0 0 0 .23.398c.15.092.342.12.475.12l1.66-.001q.017 0 .023-.015l.575-1.28a.025.025 0 0 0-.024-.035m-6.93-4.937H3.1a.032.032 0 0 0-.034.033c0 1.048-.01 2.795-.01 6.829c0 .288-.269.262-.28.262h-.74c-.04.001-.044.004-.04.047c.001.037.465 1.064.555 1.263c.01.02.03.033.051.033c.157.003.767.009.938-.014c.153-.02.3-.06.438-.132c.3-.156.49-.419.595-.765c.052-.172.075-.353.075-.533q.003-3.495-.007-6.991a.03.03 0 0 0-.032-.032zm11.784 6.896q-.002-.02-.024-.022h-1.465c-.048-.001-.049-.002-.05-.049v-4.66c0-.072-.005-.07.07-.07h.863c.08 0 .075.004.075-.074V8.393c0-.082.006-.076-.08-.076h-3.5c-.064 0-.075-.006-.075.073v1.445c0 .083-.006.077.08.077h.854c.075 0 .07-.004.07.07v4.624c0 .095.008.084-.085.084c-.37 0-1.11-.002-1.304 0c-.048.001-.06.03-.06.03l-.697 1.519s-.014.025-.008.036s.013.008.058.008q2.622.003 5.243.002c.03-.001.034-.006.035-.033zm4.177-3.43q0 .021-.02.024c-.346.006-.692.004-1.037.004q-.021-.003-.022-.024q-.006-.651-.01-1.303c0-.072-.006-.071.07-.07l.733-.003c.041 0 .081.002.12.015c.093.025.16.107.165.204c.006.431.002 1.153.001 1.153m2.67.244a1.95 1.95 0 0 0-.883-.222h-.18c-.04-.001-.04-.003-.042-.04V10.21q.001-.198-.025-.394a1.8 1.8 0 0 0-.153-.53a1.53 1.53 0 0 0-.677-.71a2.2 2.2 0 0 0-1-.258c-.153-.003-.567 0-.72 0c-.07 0-.068.004-.068-.065V7.76c0-.031-.01-.041-.046-.039H17.93s-.016 0-.023.007q-.008.008-.008.023v.546c-.008.036-.057.015-.082.022h-.95c-.022.002-.028.008-.03.032v1.481c0 .09-.004.082.082.082h.913c.082 0 .072.128.072.128v1.148s.003.117-.06.117h-1.482c-.068 0-.06.082-.06.082v1.445s-.01.068.064.068h1.457c.082 0 .076-.006.076.079v3.225c0 .088-.007.081.082.081h1.43c.09 0 .082.007.082-.08v-3.27c0-.029.006-.035.033-.035l2.323-.003a.7.7 0 0 1 .28.061a.46.46 0 0 1 .274.407c.008.395.003.79.003 1.185c0 .259-.107.367-.33.367h-1.218c-.023.002-.029.008-.028.033q.276.655.57 1.303a.05.05 0 0 0 .04.026c.17.005.34.002.51.003c.15-.002.517.004.666-.01a2 2 0 0 0 .408-.075c.59-.18.975-.698.976-1.313v-1.981q.001-.191-.034-.38c0 .078-.029-.641-.724-.998"
                  />
                </svg>
              </a>
            </li>
            <li>
              <a href="https://gitee.com/junyiz" target="_blank">
                <svg
                  stroke="currentColor"
                  fill="currentColor"
                  width="0.8em"
                  height="0.8em"
                  viewBox="0 0 24 24"
                  role="img"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.984 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.016 0zm6.09 5.333c.328 0 .593.266.592.593v1.482a.594.594 0 0 1-.593.592H9.777c-.982 0-1.778.796-1.778 1.778v5.63c0 .327.266.592.593.592h5.63c.982 0 1.778-.796 1.778-1.778v-.296a.593.593 0 0 0-.592-.593h-4.15a.592.592 0 0 1-.592-.592v-1.482a.593.593 0 0 1 .593-.592h6.815c.327 0 .593.265.593.592v3.408a4 4 0 0 1-4 4H5.926a.593.593 0 0 1-.593-.593V9.778a4.444 4.444 0 0 1 4.445-4.444h8.296z"
                  />
                </svg>
              </a>
            </li>
            <li>
              <a href="https://github.com/junyiz" target="_blank"
                ><svg
                  stroke="currentColor"
                  fill="currentColor"
                  stroke-width="0"
                  viewBox="0 0 24 24"
                  class="size-4"
                  height="1em"
                  width="1em"
                  xmlns="http://www.w3.org/2000/svg"
                  style="cursor: default"
                >
                  <path
                    d="M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"
                  ></path></svg
              ></a>
            </li>
            <a href="mailto:junyime@qq.com" target="_self"
              ><svg
                stroke="currentColor"
                fill="currentColor"
                stroke-width="0"
                viewBox="0 0 24 24"
                class="size-4"
                height="1em"
                width="1em"
                xmlns="http://www.w3.org/2000/svg"
                style="cursor: default"
              >
                <path
                  d="M3 3H21C21.5523 3 22 3.44772 22 4V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3ZM20 7.23792L12.0718 14.338L4 7.21594V19H20V7.23792ZM4.51146 5L12.0619 11.662L19.501 5H4.51146Z"
                ></path></svg
            ></a>
          </ul>
        </div>
      </footer>
    </div>

    <script>
      const btn = document.getElementById("btn");
      const err = document.getElementById("err");
      const out = document.getElementById("out");
      const successEl = document.getElementById("success");

      btn.addEventListener("click", () => {
        const uid = document.getElementById("uid").value.trim();
        const cookie = document.getElementById("cookie").value.trim();

        // Clear previous output
        out.innerHTML = "";
        successEl.innerHTML = "";
        err.innerHTML = "";

        if (!uid || !cookie) {
          err.innerHTML = "请输入 UID 和 Cookie";
          return;
        }

        // Add initial log
        addLog("正在连接服务器...");

        const rebackup = document.getElementById("rebackup").checked;
        const source = new EventSource(
          `/api/sina?u=${uid}&c=${encodeURIComponent(cookie)}&re=${rebackup ? "1" : "0"}`,
        );

        source.onmessage = function (event) {
          if (event.data === "SSEEND") {
            addLog("备份完成！");
            successEl.innerHTML = `
                        <p>✅ 博客备份成功！</p>
                        <p>预览博客: <a href="https://immich.cn/blog/${uid}/" target="_blank">https://immich.cn/blog/${uid}/</a></p>
                        <p>下载压缩包: <a href="https://immich.cn/blog/${uid}.zip" target="_blank">https://immich.cn/blog/${uid}.zip</a></p>
                        <p>donation: <a href="https://gitee.com/junyiz/dature/raw/master/images/wechat.jpg" target="_blank">buy me a tea</a></p>
                    `;
            source.close();
          } else if (event.data === "HEARTBEAT") {
            addLog("...");
          } else {
            addLog(event.data);
          }
        };

        source.onerror = function () {
          addLog("❌ 连接错误，请重试");
          source.close();
        };
      });

      function addLog(message) {
        const line = document.createElement("div");
        line.className = "console-line";
        line.textContent = "> " + message;
        out.appendChild(line);
        out.scrollTop = out.scrollHeight;
      }
    </script>
  </body>
</html>
